{% extends "base.html" %}

{% block content %}
<h2>{{ product.name }}</h2>

<p>Lote seleccionado: {{ batch.quantity }} uds — caduca {{ batch.expiration_date }}</p>

<form method="post" action="{% url 'scan_action' batch.id %}">
    {% csrf_token %}

    <!-- Botón EXTRAER -->
    <button type="submit" name="mode" value="consume" class="btn btn-danger">
        Extraer 1 unidad
    </button>

    {% if product.track_open_state %}
    <div class="mt-4">
        <label for="days"><strong>Días que dura tras abrir:</strong></label>
        <input type="number" name="days" min="1"
               value="{{ product.default_open_shelf_life_days }}"
               class="form-control">
    </div>

    <button type="submit" name="mode" value="open" class="btn btn-success mt-3">
        Marcar 1 unidad como abierta
    </button>
    {% endif %}
</form>

<a href="{% url 'scan' %}" class="btn btn-secondary mt-4">Cancelar</a>
{% endblock %}
